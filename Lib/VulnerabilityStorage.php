<?php
/**
 * Created by JetBrains PhpStorm.
 * User: torben
 * Date: 3/8/12
 * Time: 11:00 AM
 */
class VulnerabilityStorage
{
    private $hashes = array();
    /**
     * @var VulnerabilityDescription[]
     */
    private $vulnerabilities = array();

    public function add($vulnerability) {
        if (is_array($vulnerability)) {
            foreach ($vulnerability as $vuln) {
                $this->add($vuln);
            }
        } else {
            $hash = md5(serialize($vulnerability));
            if (!isset($this->hashes[$hash])) {
                $this->hashes[$hash] = true;
                $this->vulnerabilities[] = $vulnerability;
            }
        }
    }
    public function get() {
        return $this->vulnerabilities;
    }
}
